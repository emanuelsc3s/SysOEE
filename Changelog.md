# Changelog

## [Unreleased]
- Ajustado o campo de data dos lotes no `ApontamentoOEE` para entrada e exibição em formato brasileiro (dd/mm/aaaa) com validação.
- Tratado erro de sessão expirada ao validar usuário no `ApontamentoOEE`, com limpeza de sessão e aviso para novo login.
- Ajustada a tipagem do gerador de UUID para compatibilidade com build em TypeScript sem depender do tipo global de `crypto`.
- Adicionado fallback de geração de UUID nos apontamentos locais para evitar erro `crypto.randomUUID` em ambientes sem suporte.
- Corrigida a normalização do valor de perdas no `ApontamentoOEE` para evitar escala incorreta ao salvar no banco.
- Melhorada a entrada de perdas no `ApontamentoOEE` com formatação pt-BR em tempo real, limite de 15 dígitos e até 4 casas decimais.
- Corrigida a geração das linhas horárias no registro de produção ao carregar turnos por `oeeturno_id`, exibindo todas as horas do turno com mesclagem dos dados existentes.
- Adicionado redirecionamento do OeeTurno com `oeeturno_id` e exibição do ID no título do Diário de Bordo.
- Removida a funcionalidade de retrabalho no apontamento de qualidade, cálculo do OEE e persistência local.
- Ajustada a ordenação da listagem de velocidades nominais para usar ordem natural/ascendente por linha e depois por referência do produto (ex: 07030001 antes de 07030003 dentro da mesma linha).
- Removido o ícone SVG da coluna "Linha de Produção" na tabela da página de Velocidade Nominal.
- Removida a coluna ID da visualização da tabela na página de Velocidade Nominal.
- Alterado o rótulo do card "Equipamentos" para "Linha de Produção" na página Home.
- Adicionado card de navegação para "Velocidade Nominal" na página Home, redirecionando para `/oee-linha-velocidade`, posicionado logo após o card de "Equipamentos".
- Ajustado o estilo tipográfico do título e subtítulo no `AppHeader` para melhorar legibilidade e hierarquia visual.
- Reduzido o espaçamento vertical entre título e subtítulo no `AppHeader`.
- Ajustado o espaçamento e a altura de linha do bloco de título no `AppHeader`.
- Ajustado o tamanho da logomarca no `AppHeader` para ficar mais proporcional ao cabeçalho.
- Ajustadas a largura e a altura da logomarca no `AppHeader` para ocupar melhor o cabeçalho.
- Ajustada a largura da logomarca no `AppHeader` para 132px.
- Ajustado o padding direito do cabeçalho do `ApontamentoOEE` para alinhar o espaço externo dos botões com a lateral direita.
- Ajustado o estilo e as dimensões dos botões do `ApontamentoOEE` para o padrão visual do `OeeTurno`.
- Ajustado o botão Voltar no `ApontamentoOEE` para sempre redirecionar para `OeeTurno`.
- Removido o botão de Dashboard do cabeçalho do Diário de Bordo no `ApontamentoOEE`.
- Corrigida a dependência de `useEffect` no `useAuth` para evitar avisos de lint e reexecuções desnecessárias.
- Bloqueada a exclusão de registros de produção quando o turno está Encerrado/Fechado, com validação antes do modal e antes da exclusão.
- Corrigida a quebra do modal de busca de SKU quando a lista de produtos não está disponível.
- Ajustadas mensagens de erro do apontamento de produção para indicar falhas de permissão no Supabase.
- Ajustada a busca de tipos de parada para consultar `tboee_parada` no Supabase e removida a exibição de Grande Parada na hierarquia.
- Implementada persistência da produção no Supabase (`tboee_turno_producao`) com CRUD, auditoria e soft delete na guia Produção.
- Integrada a velocidade nominal via `tbvelocidadenominal` para salvar registros de produção.
- Atualizado o cálculo do OEE para usar os dados de produção persistidos no Supabase.
- Estabilizada a função de cálculo de perdas para evitar recriações e dependências instáveis no hook de recálculo do OEE.
- Gerado CSV de produtos para importação na `tbproduto` do Supabase.
- Modal de busca de Produto SKU agora consulta `tbproduto` no Supabase com `deletado = 'N'`.
- Ajustado o carregamento de produção no `ApontamentoOEE` ao abrir turnos pela lista, com fallback por data/turno/produto.
- Ajustado o idioma dos campos de hora do `ApontamentoOEE` para exibição em formato 24h pt-BR.
- Forçado o formato 24h nos campos de hora do `ApontamentoOEE` com entrada textual e normalização de valores.
- Adicionado botão de atualização da consulta no modal de busca de linha de produção.
- Ajustado o layout do bloco de busca do modal de linha de produção para seguir o padrão do OeeTurno.
- Corrigido o alinhamento do botão Atualizar no modal de busca de linha de produção.
- Ajustado o alinhamento responsivo do bloco de busca do modal de linha de produção.
- Ajustado o estilo do campo de busca do modal de linha de produção para seguir o padrão do OeeTurno.
- Ajustado o estilo do seletor de status no modal de linha de produção para seguir o padrão do OeeTurno.
- Adicionada cor marrom suave para o badge de "Embalagem" no modal de busca de linha de produção.
- Adicionada cor âmbar suave para o badge de "Envase+Embalagem" no modal de busca de linha de produção.
- Reordenada a coluna "Status" para ficar logo após "Código" na tabela do modal de busca de linha de produção.
- Alinhado o botão de registro de qualidade com o campo de quantidade no `ApontamentoOEE`.
- Implementada a persistência de perdas de qualidade no Supabase (`tboee_turno_perda`) na guia Qualidade do `ApontamentoOEE`.